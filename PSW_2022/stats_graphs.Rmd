---
title: "Jak siÄ™ nie daÄ‡ zmanipulowaÄ‡: podstawy wizualizacji danych"
author: "Tomasz Przechlewski"
division: "PowiÅ›laÅ„ska SzkoÅ‚a WyÅ¼sza (Kwidzyn/Poland)"
description: (c) Tomasz Przechlewski / CC-BY license 
date: "2022"
output: html_document
---

```{r setup, include=FALSE }
knitr::opts_chunk$set(echo = F, warning=F)

library(ggplot2)
library("dplyr")
library("tidyr");
library("tidyverse")
library("RColorBrewer")
library("ggpubr")
```

## W kwestii tytuÅ‚u

Darrell Huff. How to lie with statistics (142 strony/a5)

![Bill Gates poleca w 2015](./summer-books_2015_1200px_v1.jpg)

https://www.gatesnotes.com/About-Bill-Gates/Summer-Books-2015?WT.mc_id=05_19_2015_SummerBooks_GeekWire

BTW: to zdjÄ™cie (z 2015 roku) w poÅ‚Ä…czeniu z faktem, Å¼e Gates finasowaÅ‚ badania
w dziedzinie epidemiologii (na John Hopkins Univesity) staÅ‚o siÄ™ â€dowodemâ€ 
iÅ¼ za pandemiÄ… COVID19 staÅ‚ Gates

A book written by Darrell Huff in 1954 presenting an introduction to
statistics for the general reader.  Not a statistician, Huff was a
journalist [...]
     
In the 1960/1970s, it became a standard textbook introduction to
the subject of statistics for many college students [...]
one of the best-selling statistics books in history.

https://en.wikipedia.org/wiki/How_to_Lie_with_Statistics
     
KsiÄ…Å¼eczka skÅ‚ada siÄ™ z 10 rozdziaÅ‚Ã³w i jest napisana w prowokacyjny,
sposÃ³b (nienaukowy). PoszczegÃ³lne rozdziaÅ‚y moÅ¼na powiedzieÄ‡ przeszÅ‚y
do legendy i jak siÄ™ wpisze tytuÅ‚ rozdziaÅ‚u do google to zwykle moÅ¼na znaleÅºÄ‡
setki tysiÄ™cy stron cytujÄ…cych...

r1.  niereprezentatywnoÅ›Ä‡ prÃ³by;

r2. sztuczki nt. Å›redniej r3: niejasne/nieznane szczegÃ³Å‚y wynikÃ³w analizy
(statystycznie nieistotne rezulataty ogÅ‚aszane bez podania, Å¼e sÄ…
nieistotne--albo Å›rednie dla rozkÅ‚adÃ³w daleko rÃ³Å¼nych od normalnych)

r4. to samo co #r3 przy zaÅ‚oÅ¼eniu Å¼e pomiar jest mocno przybliÅ¼ony

r5. zmyÅ‚kowe wykresy (nie zaczynajÄ…ce siÄ™ od zera)
     https://en.wikipedia.org/wiki/Gee_Whiz â†’
     https://en.wikipedia.org/wiki/Misleading_graph

r6. zmyÅ‚kowe wykresy (porÃ³wnywanie jednowymiarowych wielkoÅ›ci w 2D albo 3D)
     https://thejeshgn.com/2017/11/17/how-to-lie-with-graphs/
     r7: using one thing as a way to claim proof of something else, 
     even though there's no correlation between the two 
     (teza i dowÃ³d nie sÄ… ze sobÄ… powiÄ…zane)
     https://www.secjuice.com/the-semi-attached-figure/

r8. Korelacja to nie przyczynowoÅ›Ä‡

r9. Misinforming people by the use of statistical material 
     might be called statistical manipulation, in a word, Statisticulation.
     (ten rozdzialik to podsumowanie)

10. Jak siÄ™ nie daÄ‡ oszukaÄ‡:

Who Says So? (ludzie majÄ… interesy);
     
How Does He Know? (pomiar jest czÄ™sto wysoce wadliwy);
     
Whatâ€™s Missing? (analiza jest niejasna/niepeÅ‚na);
     
Many figures (liczb nie rysunkÃ³w) lose meaning because a comparison
is missing. Kobiety w PL nie rodzÄ… dzieci; przeciÄ™tny wiek matki
w momencie urodzenia dziecka to 27 lat.
[czego NIE powiedziano: W caÅ‚ej Europie tak jest]

Did Somebody Change The Subject? (czy mÃ³wimy o tezie?)
     
Does It Make Sense? (ogÃ³lnie czy coÅ› z tego wynika na poziomie zdrowego rozsÄ…dku)

**Å»e ludzie pokÅ‚adajÄ… nadmiernÄ… ufnoÅ›Ä‡ wynikom statystycznym to zjawisko znane i komentowane od lat:**


* There are 3 kinds of lies: lies, damned lies and statistics (ogÃ³lnie znana sentencja)

* Despite its mathematical base, statistics is a much an art as it is a science (Huff s. 120;
duÅ¼o mniej znane bo ksiÄ…Å¼ka Huffa w PL nie jest specjalnie znana)

* pigs had to expend enormous labours every day upon mysterious things called "files," "reports," "minutes," and "memoranda."
These were large sheets of paper which had to be closely covered with writing, and then,
they were burnt in the furnace. (Animal Farm/Orwell; Å›winie byÅ‚y Statystykami moim zdaniem :-) )

**WprowadzajÄ…ce w bÅ‚Ä…d analizy statystyczne majÄ… siÄ™ mimo to caÅ‚kiem dobrze** jeÅ¼eli nie lepiej niÅ¼ za czasÃ³w Huffa
co pewnie wynika z nastÄ™pujÄ…cych czynnikÃ³w:

* wzrosÅ‚a liczba statystykÃ³w, czÄ™sto amatorÃ³w (kaÅ¼dy moÅ¼e dziÅ› coÅ› Å‚atwo policzyÄ‡)

* wzrosÅ‚a liczba Å‚atwo dostÄ™pnych danych

* przynajmmniej w PL edukacja statystyczna omija ten ciemny aspekt statystyki.
(Studenci sÄ… generalnie uczeni rÃ³Å¼nych metod analizy danych, a sprawy wÄ…tpliwego pomiaru sÄ… pomijane,
co daje faÅ‚szywe wraÅ¼enie wysokiej wiarygodnoÅ›ci wynikÃ³w podczas gdy 
jak wiemy obowiÄ…zuje **GiGo**.)


**Nie tylko wykresami moÅ¼na wprowadziÄ‡ w bÅ‚Ä…d** (w sposÃ³b zamierzony lub nie)
ale ten wykÅ‚ad jest o wykresach. Bo wykresy sÄ… powszechne. 
Bo wykresy statystyczne staÅ‚y siÄ™ ulubionÄ… formÄ… prezentacji wynikÃ³w przez media w tym media elektroniczne i spoÅ‚ecznoÅ›ciowe (jesteÅ›my zalewani wykresami, ktÃ³re majÄ… coÅ› udowodniÄ‡.)
Bo nie moÅ¼na na raz o wszystkim. 

## Po co sÄ… tworzone wykresy statystyczne?

Wykresy statystyczne moÅ¼na tworzyÄ‡ w nastÄ™pujÄ…cych trzech celach:

1. **Dekoracjnym** (aby przyciÄ…gnÄ…Ä‡ czyjÄ…Å› uwagÄ™; dokument bez obrazkÃ³w jest nudny,
kolorowe zdjÄ™cia sÄ… lepsze niÅ¼ biaÅ‚o-czarne;
fantazyjne rysunki sÄ… lepsze niÅ¼ proste, *forma jest krÃ³lem, treÅ›Ä‡ nie ma znaczenia*)

2. **ObjaÅ›niajÄ…cym** (aby lepiej wyjaÅ›niÄ‡ komuÅ› pewne zjawisko.
UwaÅ¼a siÄ™, Å¼e obraz jest warty tysiÄ™cy sÅ‚Ã³w)

3. **Eksploracyjnym** (wyszukiwanie wzorcÃ³w danych na eksploracyjnym/wstÄ™pnym etapie analizy danych)

SkoncentrujÄ™ siÄ™ na drugim punkcie, tj. na **skutecznych** (effective) graficznych
metodach objaÅ›niania zaleÅ¼noÅ›ci w danych. Przy czym jedna metoda (graficzna) jest bardziej **skuteczna** niÅ¼ inna, jeÅ›li zawarta
w niech informacja jest sprawniej/Å‚atwiej odczytywana przez odbiorcÄ™ [Robbins 2005]


## Rodzaje wykresÃ³w

NiektÃ³re wykresy sÄ… lepsze od innych:

* **Zalecane**: wykresy punktowe, wykresy sÅ‚upkowe, wykresy liniowe, histogramy , wykresy paskowe (stripcharts),
panele (zamiast uÅ‚oÅ¼onych skumulowanych sÅ‚upkÃ³w lub wykresÃ³w wieloliniowych),
wykresy rozrzutu (dwie zmienne)

* **Niezalecane**: wykresy koÅ‚owe, wykresy bÄ…belkowe, skumulowane wykresy sÅ‚upkowe, wykresy wieloliniowe


## KÄ…cik historyczny

Wykresy sÅ‚upkowe/liniowe/koÅ‚owe zostaÅ‚y wymyÅ›lone przez Williama Playfaira (ekonomista!) w XVIII wieku.
Wykresy kropkowe wymyÅ›liÅ‚ John Cleveland (lata 80.).
Wykresy pudeÅ‚kowe zaproponowaÅ‚ John Tukey (lata 70.)

![](./WP.png)

WiÄ™cej wykresÃ³w Playfaira moÅ¼na znaleÅºÄ‡ za poÅ›rednictwem google lub w
[artykule Syamnzika] (http://www.math.usu.edu/symanzik/papers/2009_cost/editorial.html)

StatystykÄ… zajmowaÅ‚a siÄ™ teÅ¼ Florence Nightingale. Wykres poniÅ¼ej nazywa siÄ™
rÃ³Å¼Ä… Nightingale. Jest to rodzaj skumulowanego wykresu sÅ‚upkowego, ale w ukÅ‚adzie biegunowym.

![](./FN_diagram.jpg)


WycinkÃ³w (biegunowych sÅ‚upkÃ³w) jest dwanaÅ›cie -- tyle ile miesiÄ™cy.
DÅ‚ugoÅ›Ä‡ promienia a co za tym idzie wielkoÅ›Ä‡ pola wycinka zaleÅ¼y od wielkoÅ›ci zjawiska,
ktÃ³ry reprezentuje (liczba zmarÅ‚ych z powodu: ran, chorÃ³b oraz innych przyczyn)
Diagramy FN nie przyjÄ™Å‚y siÄ™, no ale nie kaÅ¼dy nowy pomysÅ‚ jest od razu genialny...


## Metafory graficzne (graphic features)

Wizualizacja danych = zakodowanie zaleÅ¼noÅ›ci miÄ™dzy liczbami (aka informacji iloÅ›ciowej) za pomocÄ… **metafor graficznych** (figury geometryczne,
kÄ…ty, kolory, poÅ‚oÅ¼enie itp.). NiektÃ³re metafory sÄ… lepsze niÅ¼ inne (z punktu widzenia skutecznoÅ›ci)


Wg William S. Cleveland (tego od stripcharts) oraz  Robert McGill (*Graphical Perception: Theory, Experimentation,
and Application to the Development of Graphical Methods*, JASA 1984) uporzÄ…dkowali
**metafory graficzne** w nastÄ™pujÄ…cej kolejnoÅ›ci (od najskuteczniejszej do najmniejskutecznej)

* PoÅ‚oÅ¼enie na jednakowej skali i wspÃ³lnej **linii bazowej**

* PoÅ‚oÅ¼enie na jednakowej skali 

* DÅ‚ugoÅ›Ä‡

* KÄ…t

* Powierzchnia

* ObjÄ™toÅ›Ä‡ (OK pseudo 3D)

* Kolor (odcieÅ„), kolor (nasycenie), kolor (gÄ™stoÅ›Ä‡ czerni)

MoÅ¼e zaskakiwaÄ‡ niska efektywnoÅ›Ä‡ koloru, ale pokaÅ¼emy Å¼e tak jest w istocie.

Najbardziej efektywna jest ocena poÅ‚oÅ¼enia (odlegÅ‚oÅ›ci) na
jednakowej skali i wspÃ³lnej linii bazowej

Ocena wielkoÅ›ci kÄ…ta nie jest precyzyjna (trudno jest porÃ³wnaÄ‡ zatem dwa kÄ…ty niewiele siÄ™ rÃ³Å¼niÄ…ce).
KÄ…ty ostre sÄ… niedoszacowane podczas gdy kÄ…ty rozwarte (wiÄ™ksze niÅ¼ 90) sÄ… przeszacowane.

Ocena powierzchni jest rÃ³wnie maÅ‚o precyzyjna.
NiemoÅ¼liwe jest rozrÃ³Å¼nienie obiektÃ³w o zbliÅ¼onej powierzchni

## Jedna zmienna

### Zmienna niemierzalna: wykresy koÅ‚owe i sÅ‚upkowe

PrzykÅ‚ad: Noclegi udzielone w roku 2017 wg krajÃ³w UE (tour_occ_ninat, 
*Nights spent at tourist accommodation establishments by non residents*)

![](./nights_spent_2017.png)


```{r message=F, echo=F, warning=F, fig.width=10}
# https://www.datanovia.com/en/blog/how-to-create-a-pie-chart-in-r-using-ggplot2/
df <- data.frame( class=c("Spain", "UK", "Italy", "France", "Greece",
    "Austria", "Germany", "Croatia", "Portugal", "Netherlands", "Rest28"),
    n=c(305907462, 213378155, 210658786, 133499991, 89284386, 86044321, 83111219,
        80176804, 48884842, 44169041, 202635615));

sum.eu <-sum(df$n)
df["prop"] <- df$n / sum.eu * 100;
df["txt.prop"] <- sprintf ("%.1f", df$prop);

df <- df %>%
  arrange(desc(class)) %>%
  mutate(ypos = cumsum(prop) - 0.5*prop)

mycols <- brewer.pal(13, "Set3")

pc1 <- ggplot(df, aes(x = "", y = prop, fill = class)) +
  geom_bar(width = 1, stat = "identity", color = "white") +
  coord_polar("y", start = 0)+
  scale_fill_manual(values = mycols) +
  ggtitle("Total nights spent by country") +
  theme_void()

pc2 <- ggplot(df, aes(x = "", y = prop, fill = class)) +
  geom_bar(width = 1, stat = "identity", color = "white") +
  coord_polar("y", start = 0)+
  geom_text(aes(y = ypos, label = txt.prop), color = "black")+
  scale_fill_manual(values = mycols) +
  ggtitle("Total nights spent by country") +
  theme_void()

## dot-plot
pc3 <- ggplot(df, aes(x = reorder(class, n) )) +
  geom_point(aes(y = prop, colour = 'prop' ), size=3) +
  xlab(label="#") + ylab(label="% ") + coord_flip()+
  ggtitle("Total nights spent by country") +
  theme(plot.title = element_text(hjust = 0.5))

## bar chart
pc4 <- ggplot(df, aes(x = reorder(class, n), y=prop)) +
  geom_bar(stat="identity", fill = 'navyblue' ) +
  xlab(label="#") + ylab(label="% ") +
  coord_flip()+ 
  ggtitle("Total nights spent by country") +
  theme(plot.title = element_text(hjust = 0.5))
```

Wykresy koÅ‚owe:

```{r  message=F, echo=F, warning=F, fig.width=10}
ggarrange(pc1, pc2, ncol = 2, nrow = 1)
```

Wykresy sÅ‚upkowe:

```{r  message=F, echo=F, warning=F, fig.width=10}
ggarrange(pc3, pc4, ncol = 2, nrow = 1)
```

### Zmienna mierzalna: histogram

Histogram sÅ‚uÅ¼y do wizualizacji rozkÅ‚adu czÄ™stoÅ›ci. Pary wartoÅ›Ä‡/liczebnoÅ›Ä‡
sÄ… pokazywane jako prostokÄ…ty umieszczone w ukÅ‚adzie wspÃ³Å‚rzÄ™dnych. Zwykle wartoÅ›ci sÄ… grupowane
w **przedziaÅ‚y wartoÅ›ci**.

PrzykÅ‚ad: wiek laureatÃ³w Nagrody Nobla (do roku 2018 wÅ‚Ä…cznie;
 dane: [The Nobel Prize API Developer Hub](https://nobelprize.readme.io/))

```{r, cache = F, dependson = "pl_hotel_data"}
##d <- read.csv("powiaty_wskazniki_woj_regiony.csv", sep = ';',  header=T, na.string="NA");
nlf <- read.csv("nobel_laureates3.csv", sep = ';', dec = ",",  header=T, na.string="NA");
noblisci <- nrow(nlf)

ggplot(nlf, aes(x = age)) +
  geom_histogram(bins = nclass.Sturges(nlf$age), fill='forestgreen', color='aquamarine') +
  geom_text(aes(y = 150, x = 20, label = sprintf("n = %i", noblisci) ), color = "black")
```

Histogramy o szerokoÅ›ci przedziaÅ‚u rÃ³wnej 10, 5, 2 oraz 1 lat:

```{r, cache = F, echo=F, dependson = "pl_hotel_data"}
#library(ggpubr)
p1 <- ggplot(nlf, aes(x = age)) +
  geom_histogram(binwidth = 10, fill='forestgreen')
p2 <- ggplot(nlf, aes(x = age)) +
  geom_histogram(binwidth = 5, fill='forestgreen')
p3 <- ggplot(nlf, aes(x = age)) +
  geom_histogram(binwidth = 2, fill='forestgreen')
p4 <- ggplot(nlf, aes(x = age)) +
  geom_histogram(binwidth = 1, fill='forestgreen')

ggarrange(p1,p2,p3,p4)
```

Im wiÄ™cej wartoÅ›ci/przedziaÅ‚Ã³w tym histogram jest bardziej szczegÃ³Å‚owy co niekoniecznie
jest poÅ¼Ä…dane bo zaciemnia ogÃ³lny obraz. Nie ma zÅ‚otych recept na to ile powinno byÄ‡ przedziaÅ‚Ã³w,
a ich liczba determinuje ksztaÅ‚t oraz optycznÄ… wielkoÅ›Ä‡ (tj. caÅ‚kowitÄ… powierzchniÄ™).
Im mniej przedziaÅ‚Ã³w tym histogram bÄ™dzie optycznie wiÄ™kszy.

## PorÃ³wnanie rozkÅ‚adÃ³w

### Cecha niemierzalna

Standardowe podejÅ›cie:
skumulowany wykres sÅ‚upkowy (*stacked barchart*) wzglÄ™dnie grupowany wykres sÅ‚upkowy (*multiple barchart*)

CBOS realizuje co najmniej 12 razy w roku
sondaÅ¼ "Aktualne problemy i wydarzenia", na reprezentatywnej ok. 1000-osobowej prÃ³bie dorosÅ‚ych mieszkaÅ„cÃ³w Polski. (cf https://www.cbos.pl/PL/trendy/trendy.php?)

```{r, cache = F, echo=F, message=F, warning=FALSE}
dA <- read.csv("zaufanie_do_politykow_CBOS_2019.csv", sep = ';',  header=T, na.string="NA");

## kto;zaufanie;diffz;nieuf;diffn;obojetnosc;nieznajomosc

## https://stackoverflow.com/questions/17148679/construct-a-manual-legend-for-a-complicated-plot
cols <- c("zaufanie"="blue","nieufnosc"="red","nieznajomosc"="black")

### https://www.guru99.com/r-dplyr-tutorial.html#9
### Ordering factor
dA$sortOrder <- dA$zaufanie

dB <- dA %>% gather(aspekt, vv, zaufanie:nieznajomosc) %>% 
   filter(aspekt=="zaufanie" | aspekt =="nieuf" | aspekt == "nieznajomosc") %>% as.data.frame

## stacked barchart
p2 <- ggplot(dB, aes(x = reorder(kto, sortOrder), y=vv, fill=aspekt )) +
  ggtitle("Zaufanie do politykÃ³w 1/2019") +
  theme(legend.position="top") +
  xlab(label="") + 
  ylab(label="") + 
  geom_bar(position="stack", stat="identity") +
  coord_flip()
##p2

## grouped
p2dodge <- ggplot(dB, aes(x = reorder(kto, sortOrder), y=vv, fill=aspekt )) +
  ggtitle("Zaufanie do politykÃ³w 1/2019") +
  theme(legend.position="top") +
  xlab(label="") + 
  ylab(label="") + 
  geom_bar(position="dodge", stat="identity") +
  coord_flip()
##p2dodge
 
## Faceted piechar
## http://zevross.com/blog/2019/04/02/easy-multi-panel-plots-in-r-using-facet_wrap-and-facet_grid-from-ggplot2/
p3x <- ggplot(dB, aes(x = "", y=vv, fill=factor(aspekt))) + 
  ggtitle("Zaufanie do politykÃ³w 1/2019") +
   theme(legend.position="top") +
  xlab(label="") + 
  ylab(label="") + 
  facet_wrap(~kto, ncol=8) + 
  geom_bar(width = 1,position = "fill", stat="identity") + 
  coord_polar(theta="y")
##p3x

## Faceted barchart
p3A <- ggplot(dB, aes(x =kto , y=vv, fill=aspekt )) +
  ggtitle("Zaufanie do politykÃ³w 1/2019") +
  theme(legend.position="top") +
  xlab(label="") +
  ylab(label="") +
  facet_wrap(~aspekt) +
  geom_bar(stat="identity") +
  coord_flip()
##p3A

```

CzÄ™Å›ciÄ… tych badaÅ„ jest badanie zaufania do PolitykÃ³w. KtÃ³re to zaufanie
jest mierzone w taki sposÃ³b, Å¼e respondenci odpowiadajÄ… na jedno pytanie,
ktÃ³re brzmi:
*Ludzie aktywni publicznie â€“ swoim zachowaniem, tym, co mÃ³wiÄ…,
do czego dÄ…Å¼Ä… â€“ budzÄ… mniejsze lub wiÄ™ksze
zaufanie. Przedstawimy teraz Panu(i) listÄ™ osÃ³b aktywnych w Å¼yciu politycznym naszego kraju.
O kaÅ¼dej z nich proszÄ™ powiedzieÄ‡,
w jakim stopniu budzi ona Pana(i) zaufanie. OdpowiadajÄ…c,
proszÄ™ posÅ‚uÅ¼yÄ‡ siÄ™ skalÄ…, na ktÃ³rej â€“5 oznacza, Å¼e osoba ta budzi
w Panu(i) gÅ‚Ä™bokÄ… nieufnoÅ›Ä‡, 0 â€“ Å¼e jest ona Panu(i) obojÄ™tna,
a +5 oznacza, Å¼e ma Pan(i) do tej osoby peÅ‚ne zaufanie. OczywiÅ›cie
moÅ¼e siÄ™ Pan(i) posÅ‚ugiwaÄ‡ innymi ocenami tej skali. JeÅ¼eli kogoÅ› Pan(i) nie zna, proszÄ™ powiedzieÄ‡*

Odsetki badanych wyraÅ¼ajÄ…cych zaufanie â€“ wskazania punktÃ³w od +1 do +5,
nieufnoÅ›Ä‡ â€“ wskazania punktÃ³w od â€“1 do â€“5,
obojÄ™tnoÅ›Ä‡ â€“ 0

W zestawieniu CBOS pomija odpowiedzi â€trudno powiedzieÄ‡â€ 
i odmowy odpowiedzi. 

Analiza CBOS (przykÅ‚ad raportu jest 
w pliku `zaufanie_do_politykow_CBOS_2019.pdf`) posÅ‚uguje siÄ™ 
skumulowanym wykresem sÅ‚upkowym (*stacked barchart*):

```{r cache = F, echo=F, message=F, warning=FALSE, fig.width=10}
ggarrange(p2, p2dodge, ncol = 2, nrow = 1)
```

Skumulowany wykres sÅ‚upkowy jest w zasadzie jest wykresem koÅ‚owym,
tyle Å¼e zamiast kÃ³Å‚ek sÄ… prostokÄ…ty (cf https://eagereyes.org/techniques/stacked-bars-are-the-worst). 
MoÅ¼na Å‚atwo porÃ³wnywaÄ‡ 
Å‚Ä…cznÄ… wartoÅ›Ä‡ albo wartoÅ›Ä‡ przedstawionÄ… za pomocÄ… pierwszego sÅ‚upka
(bo majÄ… wspÃ³lnÄ… liniÄ™ dla wartoÅ›ci zero, *common baseline*).
PozostaÅ‚e sÅ‚upki nie sÄ… oparte o wspÃ³lnÄ… liniÄ™ zerowej wartoÅ›ci i w zwiÄ…zku
z tym porÃ³wnanie ich wartoÅ›ci jest trudne.
W  przykÅ‚adzie kaÅ¼dy sÅ‚upek ma 3 kategorie a juÅ¼ jest trudno 
wskazaÄ‡ czy nieufnoÅ›Ä‡ do PawÅ‚a Kukiza jest wiÄ™ksza czy mniejsza od nieufnoÅ›ci
do Roberta Biedronia. Gorzej wykres sugeruje, Å¼e nieufnoÅ›Ä‡ do Biedronia
jest wiÄ™ksza niÅ¼ do Kukiza, podczas gdy w rzeczywistoÅ›ci jest odwrotnie.
Podobnie trudno jest okreÅ›liÄ‡ dla konkretnego polityka
czy zaufanie jest wiÄ™ksze od nieufnoÅ›ci albo o ile jest wiÄ™ksze (lub mniejsze)..

Zamiast kumulowaÄ‡ czy grupowaÄ‡ moÅ¼na wykreÅ›liÄ‡
sÅ‚upki z kaÅ¼dej kategorii oddzielniem na wspÃ³lnej linii zera:

```{r cache=F, echo=F, message=F, warning=FALSE}
p3A
```
Takie coÅ› nazywa siÄ™ panelem. MoÅ¼na zamiast wykresÃ³w sÅ‚upkowych
uÅ¼yÄ‡ koÅ‚owych (jeÅ¼eli ktoÅ› jest jeszcze nieprzekonany Å¼e wykres koÅ‚owy nie ma Å¼adnych zalet
w porÃ³wnaniu do sÅ‚upkowego):

```{r cache = F, echo=F, message=F, warning=FALSE, fig.width=10}
p3x
```

### Cecha mierzalna: wykresy pudeÅ‚kowe (*box and whisker plot*)

**Wykresy pudeÅ‚kowe** sÄ… znacznie lepsze niÅ¼ histogramy do porÃ³wnywania rozkÅ‚adÃ³w.

Konstrukcja (typowego) wykresu pudeÅ‚kowego: Å›rodkowa kreska to mediana. GÃ³ra/dÃ³Å‚
prostokÄ…ta to IQR pierwszy/trzeci kwartyl (czyli  wysokoÅ›Ä‡ prostokÄ…ta to rozstÄ™p miÄ™dzykwartylowy.)
Fantazyjne kreski nad/pod prostokÄ…tem zwane wÄ…sami
(kot ma *whiskers* a czÅ‚owiek *mustache*) sÄ… definiowane jako $Q_*\pm 1,5 \times \mathrm{IQR}$
Symbole powyÅ¼ej/pod wÄ…sami (zwykle otwarte kÃ³Å‚ka) sÄ… wartoÅ›ciami nietypowymi (*outliers*)

ZwrÃ³Ä‡ uwagÄ™ na sztuczkÄ™: wartoÅ›ci nietypowe nie sÄ… definiowane jako (na przykÅ‚ad) gÃ³rne/dolne
1% wszystkich wartoÅ›ci (bo wtedy **kaÅ¼dy rozkÅ‚ad** miaÅ‚by outliers);
ale jako wartoÅ›ci mniejsze/wiÄ™ksze od $Q_* \pm 1,5 \times \mathrm{IQR}$.
Wszystkie wartoÅ›ci rozkÅ‚adÃ³w o umiarkowanej zmiennoÅ›ci mieszczÄ… siÄ™ wewnÄ…trz czegoÅ› takiego.

PrzykÅ‚ad: wiek laureatÃ³w Nagrody Nobla

```{r, cache = F, echo=T }
#nlf <- read.csv("nobel_laureates3.csv", sep = ';', dec = ",",  header=T, na.string="NA");
#noblisci <- nrow(lnf)

ggplot(nlf, aes(x=category, y=age, fill=category)) + geom_boxplot() + ylab("years") + xlab("");
```

### Cecha mierzalna: wykresy paskowe (*strip charts*)

Wykres paskowy przedstawia *rozkÅ‚ad* wartoÅ›ci na osi. Taki wykres moÅ¼e byÄ‡
stosowany zamiast wykresu podeÅ‚kowego (poniewaÅ¼ zachowujÄ… wiÄ™cej informacji o danych).


PrzykÅ‚ad: wiek laureatÃ³w Nagrody Nobla

```{r, cache = F, echo=F, dependson = "pl_hotel_data", fig.width=10}
p4<-ggplot(nlf, aes(x=category, y=age)) +
   geom_jitter(position=position_jitter(0.0), cex=.2, color='forestgreen') +
  theme(axis.text = element_text(size = 5))

p3<-ggplot(nlf, aes(x=category, y=age)) +
  geom_point(alpha = 1/20, color='darkorange2') +
  theme(axis.text = element_text(size = 5))
  #geom_point(size = .3)
  #geom_jitter(position=position_jitter(0.05), cex=1.2)
ggarrange(p4,p3, ncol = 2, nrow = 1)
```

NajwiÄ™kszym problemem zwiÄ…zanym z wykresem paskowym jest nakÅ‚adanie siÄ™ punktÃ³w.
MoÅ¼e to powaÅ¼nie znieksztaÅ‚ciÄ‡ wykres.

Nie ma dobrego rozwiÄ…zania tego problemu, ale istnieje kilka technik, ktÃ³re mogÄ… pomÃ³c:
uÅ¼yj mniejszych kropek, uÅ¼yj pÃ³Å‚przezroczystych kropek (prawy panel), uÅ¼yj **jittera**.

Jitter --- maÅ‚y losowy szum dodany do danych (poniÅ¼ej; wiÄ™kszy *jitter* na prawym panelu)

```{r, cache = F, echo=F, dependson = "pl_hotel_data"}
p1<-ggplot(nlf, aes(x=category, y=age)) +
   geom_jitter(position=position_jitter(0.2), cex=.2, color='forestgreen') +
  theme(axis.text = element_text(size = 5))
   
p2<-ggplot(nlf, aes(x=category, y=age)) +
   geom_jitter(position=position_jitter(0.1), cex=.2, color='darkorange2') +
  theme(axis.text = element_text(size = 7))

ggarrange(p2,p1, ncol = 2, nrow = 1)
```

## Dwie zmienne

Celem wizualizacji jest pokazanie zaleÅ¼noÅ›ci pomiÄ™dzy zmiennymi.

Wykres rozproszenia (wykres XY)
PrzykÅ‚ad: SpoÅ¼ycie miÄ™sa a GDP (Åšwiat/2013 rok; dane FAO)

```{r, cache = F, echo=F, warning=FALSE}
### SpoÅ¼ycie miÄ™sa a GDP (Åšwiat 2013 rok)

```{r message=FALSE, echo=FALSE}
## Dane FAO/WorldBank
meatCons <- read.csv(file='meatCons_vs_GDP.csv',sep=';',header=T)
ggplot(meatCons, aes(x = gdp2013, y = y2013)) +
  geom_point(color="steelblue", size=1) +
  ggtitle("PrzeciÄ™tne spoÅ¼ycie miÄ™sa vs GDP (2013)") +
  geom_smooth(method = "lm") +
  geom_smooth(method = "loess", color="red")
```

## Szeregi czasowe

Wykres liniowy lub sÅ‚upkowy. Liniowy jest bardziej odpowiedni w przypadku
szeregu momentÃ³w a sÅ‚upkowy okresÃ³w.

Cel: pokazaÄ‡ dynamikÄ™ zmian roÅ›nie/maleje i jak szybko takÅ¼e porÃ³wnaÄ‡ dynamikÄ™,
czyli oceniÄ‡ zmiany jednej zmniennej wzglÄ™dem drugiej...

```{r echo=F, fig.width=10}
f0lex <- read.csv("demo_mlifetable_tabular.csv", sep = ';',  header=T, na.string="NA" )
countries <- c ('PL', 'DE', 'FR', 'UK', 'IT', 'BE', 'SE', 'FI') ## byÅ‚o

flex <- f0lex %>% filter ( geo %in% countries & sex == "T" & year > 2000 &
                      unit == 'LIFEXP' & age == "Y_LT1")  %>% as.data.frame()

p1 <- ggplot(flex, aes(x=year, y=value, color=geo)) +
 #geom_smooth(method="loess", se=F, span=spanV, size=.4) +
 ggtitle("Oczekiwana dÅ‚ugoÅ›Ä‡ Å¼ycia w chwili urodzenia") +
 labs(caption="Eurostat: DEMO_MLIFETABLE") +
 geom_point(size=.8, alpha=.5) +
ylab(label="lata") + xlab(label="") +
  theme(plot.title = element_text(size=10)) +
 geom_line(size=.4)
##p1

countriesx <- c ('PL', 'NO', 'AT', 'TR',  'CZ', 'DE', 'FR', 'UK', 'IT', 
                 'BE', 'SE', 'FI', 'BG', 'LT', 'ES') ## byÅ‚o
flex <- f0lex %>% filter ( geo %in% countriesx & sex == "T" & year > 2000 &
                             unit == 'LIFEXP' & age == "Y_LT1")  %>% as.data.frame()
p2 <- ggplot(flex, aes(x=year, y=value, color=geo)) +
  #geom_smooth(method="loess", se=F, span=spanV, size=.4) +
  ggtitle("Oczekiwana dÅ‚ugoÅ›Ä‡ Å¼ycia w chwili urodzenia") +
  labs(caption="Eurostat: DEMO_MLIFETABLE") +
  geom_point(size=.8, alpha=.5) +
  ylab(label="lata") + xlab(label="") +
   theme(plot.title = element_text(size=10)) +
  geom_line(size=.4)
##p2

countriesy <- c ('PL', 'CZ') ## byÅ‚o
flex <- f0lex %>% filter ( geo %in% countriesy & sex == "T" & year > 2000 &
                             unit == 'LIFEXP' & age == "Y_LT1")  %>% as.data.frame()
p3 <- ggplot(flex, aes(x=year, y=value, color=geo)) +
  #geom_smooth(method="loess", se=F, span=spanV, size=.4) +
  ggtitle("Oczekiwana dÅ‚ugoÅ›Ä‡ Å¼ycia w chwili urodzenia") +
  labs(caption="Eurostat: DEMO_MLIFETABLE") +
  geom_point(size=.8, alpha=.5) +
  ylab(label="lata") + xlab(label="") +
   theme(plot.title = element_text(size=10)) +
  geom_line(size=.4)
##p3

flex.x <- pivot_wider(flex, names_from = 'geo', values_from = value) %>%
  mutate (diff = PL - CZ)

p4 <- ggplot(flex, aes(x=year, y=value, color=geo)) +
  #geom_smooth(method="loess", se=F, span=spanV, size=.4) +
  ggtitle("Oczekiwana dÅ‚ugoÅ›Ä‡ Å¼ycia w chwili urodzenia") +
  labs(caption="Eurostat: DEMO_MLIFETABLE") +
  geom_point(size=.8, alpha=.5) +
  coord_cartesian(ylim = c(0, NA)) +
  ylab(label="lata") + xlab(label="") +
   theme(plot.title = element_text(size=10)) +
  geom_line(size=.4)
##p4

ggarrange(p1, p2, ncol = 2, nrow = 1)
ggarrange(p3, p4, ncol = 2, nrow = 1)
```

## OgÃ³lne zasady projektowe

* ZrozumiaÅ‚a **treÅ›Ä‡**: Czytelnik/odbiorca wyraÅºnie **rozumie**, co jest na wykresie:
podane sÄ… opisy skal/etykiety/wyjaÅ›nienia (pamiÄ™tasz co/kiedy/gdzie?)

* Przejrzysta **forma**: czytelnik/odbiorca wyraÅºnie widzi to, co jest na wykresie
(bez splÄ…tanych linii, nakÅ‚adajÄ…cych siÄ™ elementÃ³w itp.)

![](./chart_example.png)

* WyrÃ³Å¼niaj dane, a nie linie siatki, etykiety, zbÄ™dne legendy czy bezsensowne strzaÅ‚ki.
Im proÅ›ciej tym lepiej. 

* Znaczniki i etykiety osi powinny byÄ‡ umieszczone na zewnÄ…trz. WartoÅ›ci na osi X rosnÄ…
zawsze od lewej do prawej, wartoÅ›ci na osi Y od doÅ‚u do gÃ³ry
**nigdy** w odwrotnym kierunku. Nie przesadzaj z liczbÄ… etykiet na osiach.

* PomyÅ›l jak wykres bÄ™dzie wyglÄ…daÅ‚ w trybie B-W nawet jeÅ¼eli w oryginale jest kolorowy
(bo ktoÅ› moÅ¼e go skserowaÄ‡) lub o poÅ‚owÄ™ mniejszy lub jeszcze mniejszy (smartfon).

* Nigdy nie uÅ¼ywaj **wiÄ™cej** metafor, niÅ¼ jest wymiarÃ³w w zbiorze danych.
ProstokÄ…ty na wykresie sÅ‚upkowym powinny byÄ‡ w jednym kolorze.

* Wykresy 3D to katastrofa. Nikt jeszcze nie widziaÅ‚ wykresu 3D ktÃ³ry byÅ‚by
bardziej czytelny niÅ¼ jego odpowiednik 2D.

* W miarÄ™ moÅ¼liwoÅ›ci uÅ¼ywaj wspÃ³lnej linii bazowej. W wykresach liniowych wybieraj optymalne proporcje
(nachylenie 45). UÅ¼yj skali logarytmicznej, gdy zakres danych jest
ogromy, nie stosuj przerywanych skal, rozpoczynaj osie 0 
(ale czasami nie). Nie stosuj podwÃ³jnych osi, bo to ogromnie komplikuje interpretacjÄ™.

* Preferuj etykiety zamiast legend. Legendy zmuszajÄ… czytelnika do patrzenia tam i z powrotem
podczas studiowania wykresu.
OczywiÅ›cie, jeÅ›li nie ma miejsca na (dÅ‚ugie) etykiety, uÅ¼yj legendy.

* Wykresy wieloliniowe generalnie to zÅ‚y pomysÅ‚ (rÃ³Å¼ne skale, baÅ‚agan,
trudnoÅ›ci z ocenÄ… rÃ³Å¼nicy miÄ™dzy liniami)


## Zalecenia Edwarda Tufte

Tufte (https://www.edwardtufte.com/tufte/; wym. Tafti), 
ktÃ³ry jest -- bo ciÄ…gle Å¼yje -- znanym ekspertem (aka **guru**) 
w dziedzinie wizualizacji informacji,
zaproponowaÅ‚ dwie reguÅ‚y, ktÃ³re nazwaÅ‚ wspÃ³Å‚czynnik dane/farba (*data to ink ratio*)
oraz (wspÃ³Å‚)czynnik zakÅ‚amania (*lie factor*).

Farba to wielkoÅ›Ä‡ farby drukarskiej uÅ¼yta do narysowania wykresu. Dane to ta iloÅ›Ä‡
farby, ktÃ³ra sÅ‚uÅ¼y do narysowania danych. ReguÅ‚a postuluje, aby wspÃ³Å‚czynnik DI miaÅ‚ jak najwyÅ¼szÄ…
wartoÅ›Ä‡ (tj. zawieraÅ‚ minimum elementÃ³w zdobniczych a maksimum danych.)

KrÃ³tki video klip, ilustruje zasadÄ™ maksymalizacji DI: https://www.youtube.com/watch?v=JIMUzJzqaA8

WspÃ³Å‚czynnik kÅ‚amstwa (LF) jest  definiowany jako wzglÄ™dnÄ… wielkoÅ›Ä‡ czegoÅ› na grafice
do wielkoÅ›ci tego w danych. LF powinno byÄ‡ oczywiÅ›cie rÃ³wne 100%. WedÅ‚ug Tufte, LF wiÄ™ksze niÅ¼ 105%
lub mniejsze niÅ¼ 95% oznacza znaczÄ…ce znieksztaÅ‚cenie.
TÄ™ reguÅ‚Ä™ najlepiej wyjaÅ›niÄ‡ na przykÅ‚adzie.

Jak bardzo Hinduski sÄ… niÅ¼sze od innych kobiet?

![](./average_female_ht.png)


WyglÄ…da Å¼e bardzo, np Åotyszki sÄ… $135/31 \approx 4,35$ ponad 4 razy wyÅ¼sze...

### PrzykÅ‚ad nieco bardziej subtelny

Wybory prezydenckie 2015. WyjaÅ›nienie dla cudzoziemcÃ³w: ten *gigant* (GG) w Å›rodku to nasz **byÅ‚y prezydent**.
Facet obok niego po lewej stronie jest naszym **obecnym prezydentem** DudÄ… (AD).
Obok Dudy jest byÅ‚a gwiazda rocka Kukiz, czarny koÅ„ wyborÃ³w (CK).

Oto okÅ‚adka (lekko zmodyfikowana) wpÅ‚ywowego polskiego tygodnika z maja 2015 roku,
tuÅ¼ przed wyborami. 
OkÅ‚adka przedstawia wykres sÅ‚upkowy tyle Å¼e uatrakcyjniony w ten sposÃ³b Å¼e sÅ‚upkami sÄ… sylwetki
kandydatÃ³w. Redakcja twierdzi, Å¼e liczby sÄ… *in-sync* z wynikami najÅ›wieÅ¼szych badaÅ„.

Co moÅ¼na wydedukowaÄ‡ z tego wykresu na temat wynikÃ³w kaÅ¼dego kandydata?
O ile wynik GG jest lepszy od wyniku AD? A od wyniku CK?
KtÃ³ry kandydat jest wspierany przez gazetÄ™ (to akurat Å‚atwo :-)?

![](./Komorowski_Duda_Kukiz_sondaz_Polityka_hidden_numbers.jpg)

The lie-factor details:

![](./Komorowski_Duda_Kukiz_sondaz_Polityka_flactor_x.jpg)

Linia od butÃ³w do czubka gÅ‚owy 204mm dla GG, 134mm dla AD
dla 42.5mm dla CK. 
Zatem  $204/134=1.5$ oraz $204/42.5 \approx 4.8$. PoniewaÅ¼ $44/29 \approx 1.5$
oraz $44/9 \approx 4.8$ zatem wartoÅ›Ä‡ LF wynosi perfekcyjne 100%.

Ale czy oceniajÄ…c figury dwuwymiarowe patrzymy tylko na jeden wymiar na czy powierzchniÄ™?

JeÅ¼eli porÃ³wnamy powierzchniÄ™: $(204 * 58) /(134 * 21)= 4.20$ oraz $(204 *58)/(42.5 *15) \approx 18.56$. LF
wynosi $4.2/1.5 =280$% oraz $18.56/4.8=387$%. Przypomniam Å¼e 105% i wiÄ™cej to duÅ¼o wg Tufte...

Na marginesie: Å¼eby poprawiÄ‡ wynik GG zastosowana dwa pozastatystyczne triki
(*Can you see them?*)

Na marginesie 2: Co dokÅ‚adnie oznacza proporcje postaci i czy nie powinno byÄ‡ wysokoÅ›Ä‡ postaci? :-)

## Nachylenie 45 (*banking to 45*)

Stosunek szerokoÅ›ci do wysokoÅ›ci prostokÄ…ta nazywany
jest jego wspÃ³Å‚czynnikiem proporcji (aspect ratio).

WspÃ³Å‚czynnik proporcji okreÅ›la obszar zajmowany przez dane na wykresie.
Zmiana wspÃ³Å‚czynnika proporcji zmienia postrzeganie wykresu.
Pytanie brzmi: ktÃ³ry wspÃ³Å‚czynnik proporcji jest najlepszy?

Ocena wielkoÅ›ci nachylenia krzywej jest najlepsza jeÅ¼eli, jeÅ›li jest ono rÃ³wne 45 stopniom.
Znacznie trudniej jest okreÅ›liÄ‡ wielkoÅ›Ä‡ zmiany, jeÅ›li krzywe sÄ… prawie poziome/pionowe.
Cleveland (1988) zaproponowaÅ‚ aby wspÃ³Å‚czynnik proporcji wykresu byÅ‚
tak dobrany, Å¼eby **wiÄ™kszoÅ›Ä‡** krzywych byÅ‚a nachylona po kÄ…tem okoÅ‚o 45 stopni.

Ustawienie wspÃ³Å‚czynnika proporcji tak, aby Å›rednia wartoÅ›ci nachylenia 
wynosiÅ‚a 45 stopni, nazywa siÄ™ â€przechylaniem Å›redniej orientacji do
45 stopniâ€.

MoÅ¼na tak ustaliÄ‡ wspÃ³Å‚czynnik proporcji wykresu, aby Å›rednia waÅ¼ona segmentÃ³w linii
(waÅ¼ona dÅ‚ugoÅ›ciÄ… segmentÃ³w) wynosiÅ‚a okoÅ‚o 45 stopni. Dla programu komputerowego wyliczenie
czegoÅ› takiego nie powinno 
stanowiÄ‡ problemu, ale nie znam takiego, ktÃ³ry by coÅ› takiego umiaÅ‚.

**Ä†wiczenie**: na ktÃ³rym wykresie dynamika zjawiska jest najwiÄ™ksza? (proste)

![](./CO2M_0.jpg){width=75%}

BTW: na kaÅ¼dym wykresie sÄ… te same dane dotyczÄ…ce emisji (Å›rednia dla Maja kaÅ¼dego roku.) 
Å¹rÃ³dÅ‚o: US Government's Earth 
System Research Laboratory, Global Monitoring Division. 
(cf [CO2 PPM -- Trends in Atmospheric Carbon Dioxide](https://datahub.io/core/co2-ppm))

```{r, echo=F}
df.co <- read.csv("co2may.csv", sep = ';',  header=T, na.string="NA");
df.co["ave100"] <- df.co$average;


p1 <- ggplot(df.co, aes(x = as.Date(date))) +
  geom_line(aes(y = ave100), colour="pink", size=1.5) +
  ylab(label="co2") +  xlab(label="") +
  labs(colour = "") +
  theme(legend.position="top") +
  theme(legend.text=element_text(size=12));

p0 <- ggplot(df.co, aes(x = as.Date(date))) +
  geom_line(aes(y = ave100), colour="pink", size=1.5) +
  ylab(label="co2") +  xlab(label="") +
  labs(colour = "") +
  theme(legend.position="top") +
  coord_cartesian(ylim = c(0, NA)) +
  theme(legend.text=element_text(size=12));
ggarrange(p1, p0, ncol = 2, nrow = 1)

```


## WybÃ³r skali

SkalÄ™ logarytmicznÄ… naleÅ¼y stosowaÄ‡ jeÅ¼eli wizualizowany zbiÃ³r danych
charakteruje duÅ¼y rozstÄ™p (wartoÅ›ci znacznie siÄ™ rÃ³Å¼niÄ….)
Jako przykÅ‚ad znowu znowu laureaci nagrody Nobla, tym razem
wedÅ‚ug kraju urodzenia (`bornCountryCode`)...

Wykresy punktowe z wykorzystaniem rÃ³Å¼nych skal na osi Y (arithmetic, log2 and log10)

```{r, cache = F, echo=F, fig.width=10 }
dA <- read.csv("nobel_laureates3.csv", sep = ';', dec = ",",  header=T, na.string="NA");
##nrow(dA)
dS <-  subset(dA, (! bornCountryCode == "" )) # by country of birth
##nrow(dS) # how many

u <- table(dS$bornCountryCode)
uf <- as.data.frame(u)
##
##
##Wykresy punktowe z wykorzystaniem rÃ³Å¼nych skal na osi Y (arithmetic, log2 and log10)
##
##
names(uf)[1] = 'country'

lFreq <- log2(uf$Freq)
uf["lfreq"] <- lFreq
pc3 <- ggplot(uf, aes(x = reorder(country, Freq) )) +
  geom_point(aes(y = Freq, colour = 'Freq' ), size=1) +
  xlab(label="cc") + ylab(label="n ") + coord_flip()+
  ggtitle("Number of Nobel laureates by Country") +
  theme(axis.text = element_text(size = 7)) +
  theme(plot.title = element_text(hjust = 0.5, size =8))

pc4 <- ggplot(uf, aes(x = reorder(country, lfreq) )) +
  geom_point(aes(y = lfreq, colour = 'lfreq' ), size=1) +
  xlab(label="cc") + ylab(label="log(n) ") + coord_flip()+
  ggtitle("Number of Nobel laureates by Country") +
  theme(axis.text = element_text(size = 7)) +
  theme(plot.title = element_text(hjust = 0.5, size=8))

llFreq <- log10(uf$Freq)
uf["llfreq"] <- llFreq

pc5 <- ggplot(uf, aes(x = reorder(country, llfreq) )) +
  geom_point(aes(y = llfreq, colour = 'lfreq' ), size=1) +
  xlab(label="cc") + ylab(label="log(n) ") + coord_flip()+
  ggtitle("Number of Nobel laureates by Country") +
  theme(axis.text = element_text(size = 7)) +
  theme(plot.title = element_text(hjust = 0.5, size=8))

ggarrange(pc3, pc4, pc5, ncol = 3, nrow = 1);
```

DokÅ‚adne dane (gdyby ktoÅ› byÅ‚ ciekaw):

```{r cache = F, echo=F }
u
```

PL -- 25 noblistÃ³w ğŸ˜Š (gÅ‚Ã³wnie NiemcÃ³w i Å»ydÃ³w urodzonych 
w granicach Cesarstwa Niemieckiego wzglÄ™dnie Rosyjskiego)

## Jak siÄ™ nie daÄ‡ zmanipulowaÄ‡?

Manipulacja moÅ¼e byÄ‡ **zamierzona** lub nie. JeÅ¼eli wykres jest preparowany pod okreÅ›lonÄ… tezÄ™ moÅ¼emy mÃ³wiÄ‡
o manipulacji, ale jeÅ¼eli wykres jest **tylko** niepoprawny, to takÅ¼e moÅ¼e znieksztaÅ‚ciÄ‡
rzeczywistoÅ›Ä‡ czyli jÄ… zmanipulowaÄ‡.

OdpowiedÅº na tytuÅ‚owe pytanie
w jednym zdaniu: **nie korzystaÄ‡ (w sensie korzystaÄ‡ z danych) ze zÅ‚ych wykresÃ³w**, czyli:

1. przedstawiajÄ…cych nieokreÅ›lone wielkoÅ›ci (brak ÅºrÃ³dÅ‚a, niejasne definicje, nieokreÅ›lone cechy staÅ‚e)

2. zbudowanych niezgodnie z reguÅ‚ami sztuki. JeÅ¼eli ktoÅ› nie potrafi skonstruowaÄ‡ poprawnie wykresu, to moÅ¼e teÅ¼
jest rÃ³wnie wiarygodny na innych etapach analizy statystycznej?

3. jawnie manipulatorskich


## PrzykÅ‚ady zÅ‚ych wykresÃ³w 

Recenzowana praca na temat ruchu turystycznego w muzeum zamku w Malborku pn
Parzych Krzysztof.
[The determinants of the tourist traffic
 in the castle's museum of Malbork](http://www.ojs.ukw.edu.pl/index.php/johs/article/view/4119/pdf)
 Journal of Education, Health and Sport.
 
Praca ta demonstruje wszystkie szkolne bÅ‚Ä™dy omÃ³wione wyÅ¼ej:

![](./MBC_1.png){width=95%}

![](./MBC_2.png){width=95%}


```{r, cache = F, echo=F, warning=FALSE, error=FALSE}
#library(ggplot2)
#library(RColorBrewer)
#library(dplyr)
#library(ggarrange)

df <- data.frame( visit.freq=c("every few years", "once a year", "every few months", "once a month", "every few weeks"),
n=c(36,30, 22, 6, 6))

colors <- brewer.pal(10, "Set1");
df["label"] <- sprintf ("%.1f", df$n);

df <- df %>%
  arrange(desc(visit.freq)) %>%
  mutate(ypos = cumsum(n) - 0.5*n)

px1 <- ggplot(df, aes(x = "", y = n, fill = visit.freq)) +
  geom_bar(width = 1, stat = "identity", color = "white") +
  coord_polar("y", start = 0)+
  geom_text(aes(y = ypos, label = label), color = "black", size=3)+
  scale_fill_manual(values = colors, name="Frequency") +
  theme_void()

px2 <- ggplot(df, aes(x = reorder(visit.freq, n), y=n)) +
  geom_bar(stat="identity", fill = 'steelblue' ) +
  xlab(label="#") +
  ylab(label="% ") +
  coord_flip()+
  geom_text(aes(label=n), hjust=1.6, color="white", size=3.0)+
  ggtitle("Frequency...") +
  theme(plot.title = element_text(hjust = 0.5))

dg <- data.frame( visit.freq=c("1--2", "3--5", "6--7", "8 and more"),
n=c(78.9, 18.0, 2.1, 1.0))
dg["lab"] <- sprintf ("%.1f", dg$n);

dg <- dg %>%
  arrange(desc(visit.freq)) %>%
  mutate(ypos = cumsum(n) - 0.5*n)

px88 <- ggplot(dg, aes(x = "", y = n, fill = visit.freq)) +
  geom_bar(width = 1, stat = "identity", color = "white") +
  coord_polar("y", start = 0)+
  geom_text(aes(y = ypos, label = lab), color = "black", size=3)+
  scale_fill_manual(values = colors, name="Frequency") +
  theme_void()

px9 <- ggplot(dg, aes(x = reorder(visit.freq, n), y=n)) +
  geom_bar(stat="identity", fill = 'orange' ) +
  xlab(label="#") +
  ylab(label="% ") +
  coord_flip()+
  geom_text(aes(label=lab), hjust=-.3, color="darkgreen", size=3.0)+
  ggtitle("Length of stay (days)") +
  theme(plot.title = element_text(hjust = 0.5))

dh <- data.frame( visit.freq=c("guestrooms", "family", "camping", "hostel", "hotel", "guesthouse"),
      n=c(48.0, 23, 11, 9.0, 5.4, 3.6))

dh["lab"] <- sprintf ("%.1f", dh$n);

px3<-ggplot(dh, aes(x = reorder(visit.freq, n), y=n)) +
  geom_bar(stat="identity", fill = 'orchid2' ) +
  xlab(label="#") +
  ylab(label="% ") +
  coord_flip()+
  geom_text(aes(label=lab), hjust=-.1, color="darkgreen", size=3.0)+
  ggtitle("Type of accomodation") +
  theme(plot.title = element_text(hjust = 0.5))


px4<-ggplot(dh, aes(x = reorder(visit.freq, n) )) +
  geom_point(aes(y = n, color="blue",show.legend=F), size=3) +
  xlab(label="#") +
  ylab(label="% ") +
  coord_flip()+
  geom_text(aes(y=n, label=lab), hjust=.1, vjust=-.8, color="darkgreen", size=3.0)+
  ggtitle("Share of...") +
  scale_color_discrete(guide=F) +
  theme(plot.title = element_text(hjust = 0.5))

```

wersja bardziej czytelna (jeÅ¼eli ktoÅ› upiera siÄ™ przy wykresach koÅ‚owych):

```{r, cache = F, echo=F, warning=FALSE, error=FALSE, fig.width=10}
ggarrange(px1, px88, ncol = 2, nrow = 1);
```

jednak lepiej uÅ¼ywaÄ‡ wykresÃ³w sÅ‚upkowych:

```{r, cache = F, echo=F, warning=FALSE, error=FALSE, fig.width=10}
ggarrange(px2, px3, px4, px9, ncol = 2, nrow = 2);
```

### Jeszcze gorzej teÅ¼ moÅ¼na (yes we can:-))

Co to jest? 

![](./budzety_piechart.jpg){width=90%}
### Wykresy koÅ‚owe sÄ… znane z bylejakoÅ›ci:


![](./reklama_prasy_piechart.jpg)

### Wykresy sÅ‚upkowe teÅ¼ moÅ¼na koncertowo zepsuÄ‡ 

RozkÅ‚ad miejsc w Sejmie po wyborach w 2015 r

![](./koszmarny_barchart.jpg)

Zaznaczono dziwny przechyÅ‚ w lewo


## Dlaczego protestowali polscy nauczyciele?

CzÄ™sto pokazywany wykres majÄ…cy 
przekonaÄ‡
opiniÄ™ publicznÄ…, Å¼e nauczyciele sÄ… duÅ¼o gorsi niÅ¼ kiedyÅ›:
(PrzeciÄ™tne wynagrodzenie jako % przeciÄ™tnego ogÃ³Å‚em?)

![](procent_w_procencie_w_edukacji.jpg)

Wersja poprawione (zaczynajÄ…ce siÄ™ od zera) nie wyglÄ…dajÄ… juÅ¼ tak
dramatycznie:


```{r, cache = F, echo=F, warning=FALSE, error=FALSE}
pwp <- read.csv("pwp.csv", sep = ';',  header=T, na.string="NA");

pwp1 <- ggplot(pwp, aes(x = as.Date(date))) +
  geom_point(aes(y = prc), colour="pink", size=1.5) +
  ylab(label="") +
  theme_bw() + theme(panel.border=element_blank(), panel.grid.minor=element_blank(), axis.line = element_line(colour = "black")) +
  coord_cartesian(ylim = c(0, 106)) +
  labs(colour = "") +
  theme(legend.position="top") +
  theme(aspect.ratio=0.4)

pwp2 <- ggplot(pwp, aes(x = as.Date(date))) +
  geom_line(aes(y = prc), colour="pink", size=1.5) +
  ylab(label="") +  xlab(label="") +
  theme_bw() + theme(panel.border=element_blank(), panel.grid.minor=element_blank(), axis.line = element_line(colour = "black")) +
  coord_cartesian(ylim = c(0, 106)) +
  labs(colour = "") +
  theme(legend.position="top") +
  theme(aspect.ratio=0.4)

pwp3 <- ggplot(pwp, aes(x = as.Date(date))) +
  geom_point(aes(y = prc), colour="pink", size=1.5) +
  ylab(label="") +
  theme_bw() + theme(panel.border=element_blank(), panel.grid.minor=element_blank(), axis.line = element_line(colour = "black")) +
  labs(colour = "") +
  theme(legend.position="top") +
  theme(aspect.ratio=0.4)

pwp4 <- ggplot(pwp, aes(x = as.Date(date))) +
  geom_line(aes(y = prc), colour="pink", size=1.5) +
  ylab(label="") +
  theme_bw() + theme(panel.border=element_blank(), panel.grid.minor=element_blank(), axis.line = element_line(colour = "black")) +
  labs(colour = "") +
  theme(legend.position="top") +
  theme(aspect.ratio=0.4)
##ggarrange(pwp1, pwp2, pwp3, pwp4, ncol = 2, nrow = 2);
pwp2

```

### Wydatki publiczne na edukacjÄ™

Cd strajku nauczycieli, TVN podaje za GUS

![](tvn_wykres-edukacja-xx.png)

Ciekawostkowo, nawet GUSowi siÄ™ pomyliÅ‚o. Najpierw
udostÄ™pniÅ‚ coÅ› takiego (Wersja #1):

![](gus-wykres-edukacja-0.png)

ZastÄ…piona szybko poprawkÄ…:

![](gus-wykres-edukacja-1.png)

### Rubel crash wedÅ‚ug NYT

ZaÅ‚amanie siÄ™ kursu rubla luty/marzec 2022. 
Co jest bardzo nie tak na wykresie?

![](./Rubel_decline_NYT.png)


## DziÄ™kujÄ™ za uwagÄ™

Notatki sÄ… tutaj: https://bookdown.org/rudolf_von_ems/jak_sie_nie_dac/

Zbiory danych z przykÅ‚adÃ³w tutaj:
